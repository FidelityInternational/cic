#!/usr/bin/env bash
set -e

CURRENT_PATH="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# shellcheck source=bin/support/sh/functions/output.sh
source "${CURRENT_PATH}/support/sh/functions/output.sh"

say "$(ok "Installing OS prerequisites for Ubuntu")"
bash "${CURRENT_PATH}/support/sh/install_docker_ubuntu.sh"

say "$(ok "Fetching course images from dockerhub")"
if ! (docker pull lvlup/ci_course  && docker pull codeclimate/codeclimate)
then
    say "$(error "Failed to pull course images")"
    exit 1
fi

say "$(ok "Setting up docker network")"
docker network create cic

# shellcheck source=.env
source "${CURRENT_PATH}/../.env"
say "$(ok "Setup path: ${CURRENT_PATH}")"

say "$(ok "environment setup complete :)")"